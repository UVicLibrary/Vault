<%# alternate version of facets on form that renders using multi-select.
    Has to copy and paste more code from blacklight than default, making
    it somewhat more fragile.

    Logic taken from facets_helper_behavior.rb, #render_facet_partials and
    #render_facet_limit.
%>

<% facets_from_request(facet_field_names).each do |display_facet| %>
  <%# Omit Year Range facet because we will render it in the form %>
  <% if display_facet.items.present? %>
    <div class="form-group advanced-search-facet">
      <%= label_tag display_facet.name.parameterize, :class => "col-sm-10 h4 mt-3" do %>
        <%= facet_field_label(display_facet.name) %>
      <% end %>

      <div class="col-12">
        <%= content_tag(:select, :multiple => true,
                        :name   => "f_inclusive[#{display_facet.name}][]",
                        :id     => display_facet.name.parameterize,
                        :class  => "form-control advanced-search-facet-select") do %>
          <% display_facet.items.each do |facet_item| %>
            <%= content_tag :option, :value => facet_item.value, :selected => facet_value_checked?(display_facet.name, facet_item.value) do %>
              <%= facet_item.label %>&nbsp;&nbsp;(<%= number_with_delimiter facet_item.hits %>)
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
<% end %>
<!-- Load chosen js from CDN and initialize it on advanced search facets -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.min.js" type="text/javascript"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.min.css">
<script>
  $('.advanced-search-facet-select').chosen()
</script>
